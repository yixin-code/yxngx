# nginx
## epoll
* epoll是linux上一种高效、可扩展的I/O事件通知机制，适用于处理大量并发连接的网络应用。
### 技术概述
* epoll是linux内核为处理大批量文件描述符而改进的poll(轮询)机制，是select/poll的增强版本。
* 通过内核中维护一个事件表来避免传统select/poll机制中遍历整个文件描述符集合的开销，从而显著提高程序在大量并发连接中只有少量活跃的情况下的系统cpu利用率。
### 核心特点
* 高效性：epoll使用了基于事件的设计，通过集中式的内核事件表来管理文件描述符上的事件，避免遍历整个文件描述符集合的开销，提高事件通知效率。
* 可扩展性：epoll支持大规模并发连接，可以同时监听成千上万的文件描述符，而不受性能影响。使它特别适用于高性能、高并发的服务器应用。
* 事件驱动：epoll通过监听文件描述符上的事件来实现事件驱动的异步I/O操作，可以监听多个文件描述符，根据文件描述符上发生的事件进行相应的处理。
* 减少系统调用：epoll避免了传统的轮询方式，减少系统调用的次数，从而提高了应用程序的效率。
### 核心数据结构
* 红黑树：在linux内核中，epoll中每个监视的文件描述符都会维护一个对应的红黑树节点。这些节点按照文件描述符的大小有序排列，方便快速的查找和插入操作。
* 就绪链表：为了提高效率，epoll维护了一个就绪链表，用于记录已就绪的文件描述符，当文件描述符上的事件被触发时，内核会将文件描述添加到就绪链表中。
### 工作原理
* 创建epoll实例：通过调用epoll_create函数创建一个epoll实例，获取其文件描述符。
* 添加事件：使用epoll_ctl函数将需要监听的文件描述符添加到epoll实例中，指定需要监听的事件类型(可读，可写等)。
* 等待事件发生：调用epoll_wait函数等待事件发生，该函数会阻塞等待有事件发生或超时。
* 处理事件：当epoll_wait函数返回时，表示有事件发生，可以通过遍历返回的事件队列来获取具体的事件信息，对相应文件描述符进行处理(读取或写入数据等)
